<view class="chat-setting-page">
  <!-- 固定背景图 -->
  <image class="page-bg" src="{{currentBg}}" mode="aspectFill"></image>
  
  <!-- 固定顶部导航栏 -->
  <custom-nav title="" showBack="{{true}}" showHome="{{false}}" transparent="{{true}}" />
  
  <!-- 固定角色信息卡片 -->
  <view class="chat-header blur-glass" style="top: {{ pageInfo.navHeight }}px">
    <image class="chat-avatar" src="{{currentBg}}" mode="aspectFill"></image>
    <view class="chat-name">{{roleInfo.name}}</view>
  </view>

  <!-- 可滚动内容区域 -->
  <scroll-view
    class="scroll-content"
    scroll-y
    enhanced
    show-scrollbar="{{false}}"
    style="height: calc(100% - {{ pageInfo.navHeight}}px);"
  >
    
    <!-- 设置内容 -->
    <view class="settings-content" style="padding-bottom: {{ pageInfo.safeAreaBottom + 40}}px;">
      
      <!-- 今日对话 -->
      <!-- <view class="setting-section blur-glass">
        <view class="section-header">
          <view class="section-title">今日对话</view>
          <view class="upgrade-btn yellow-btn-text" bindtap="onUpgradeLimit">提升上限</view>
        </view>
        <view class="chat-quota">
          <text class="quota-used">{{todayChat.used}}</text>
          <text class="quota-separator"> / </text>
          <text class="quota-total">{{todayChat.total}}</text>
        </view>
      </view> -->

      <!-- 对话模式 -->
      <view class="setting-section blur-glass">
        <view class="section-title">对话模式</view>
        
        <!-- 角色扮演基础模型 -->
        <view class="mode-item switch-item">
          <view class="mode-content">
            <view class="mode-title">角色扮演基础模型</view>
            <view class="mode-desc">默认角色扮演模型</view>
          </view>
          <t-radio 
            class="mode-radio" 
            checked="{{true}}"
            disabled="{{true}}"
            icon="dot"
          />
        </view>

        <!-- 深度思考模型 -->
        <view class="mode-item switch-item">
          <view class="mode-content">
            <view class="mode-title">深度思考模型</view>
            <view class="mode-desc">专为角色设计的思考模型，更亲密</view>
          </view>
          <t-radio 
            class="mode-radio" 
            checked="{{plotInfo.ifReasoning}}"
            bind:change="onDeepThinkingChange"
            icon="dot"
            allow-uncheck
          />
        </view>

        <!-- 长对话模式 -->
        <!-- <view class="mode-item switch-item">
          <view class="mode-content">
            <view class="mode-title">长对话模式</view>
            <view class="mode-desc">专为角色设计的思考模型，更亲密</view>
          </view>
          <switch 
            class="mode-switch" 
            checked="{{chatMode.longConversation}}"
            bindchange="onLongConversationChange"
            color="#6C5CE7"
          />
        </view> -->
      </view>

      <!-- 智能体记忆力 -->
      <view class="setting-section blur-glass">
        <view class="section-header">
          <view class="section-title">
            智能体记忆力
            <t-icon name="info-circle" size="36rpx" color="#ffffff" catchtap="onMemoryDesc" />
          </view>
          <view class="memory-link" bindtap="onMemoryStrength">
            <text class="yellow-btn-text">记忆加强</text>
            <t-icon name="chevron-right" size="40rpx" color="rgba(255,255,255,0.6)" />
          </view>
        </view>
        
        <!-- 一般记忆 -->
        <memory-display 
          currentMemory="{{plotInfo.memoryCount}}"
          memoryOptions="{{memoryOptions}}"
        />
      </view>

      <!-- 其他功能设置 -->
      <view class="setting-section blur-glass">
        <view class="section-title">其他功能设置</view>
        
        <!-- 聊天背景 -->
        <view class="setting-item" bindtap="onSelectBackground">
          <view class="setting-label">聊天背景</view>
          <view class="setting-action">
            <t-icon name="chevron-right" size="40rpx" color="rgba(255,255,255,0.6)" />
          </view>
        </view>
      </view>

    </view>
    
  </scroll-view>

  <!-- 背景选择弹窗 -->
  <background-sheet id="backgroundSheet" />
  
  <!-- 记忆加强弹窗 -->
  <memory-sheet id="memorySheet" />

  <!-- 记忆力说明遮罩层 -->
  <memory-desc-overlay show="{{ showMemoryDescOverlay }}" bind:close="onCloseMemoryDesc" />
</view>

<image-uploader
  visible="{{showUploader}}"
  bind:success="onUploadSuccess"
  bind:fail="onUploadFail"
  bind:cancel="onUploadCancel"
  isPublic="true"
/>
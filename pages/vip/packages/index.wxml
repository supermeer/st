<!--pages/vip/packages/index.wxml-->
<view class="packages-page">
  <!-- 固定背景图 -->
  <!-- <image class="page-bg" src="https://yoursx-static-1371529546.cos.ap-guangzhou.myqcloud.com/chat_bg.png" mode="aspectFill"></image> -->
  
  <!-- 固定顶部导航栏 -->
  <custom-nav 
    title="" 
    showBack="{{true}}" 
    showHome="{{false}}" 
    transparent="{{true}}" 
    bind:back="onBackClick"
  />
  
  <!-- 可滚动内容区域 -->
  <scroll-view
    class="scroll-content"
    scroll-y
    enhanced
    show-scrollbar="{{false}}"
    scroll-top="{{scrollTop}}"
    style="height: calc(100% - {{ pageInfo.navHeight + pageInfo.safeAreaBottom}}px - 320rpx)"
  >
    
    <!-- 会员权益卡片 -->
    <view class="benefits-card blur-glass">
      <view class="benefits-title">开通会员，解锁高级权益</view>
      <view class="benefits-list">
        <!-- <view class="benefit-item">无限畅聊</view>
        <view class="benefit-item">记忆增强</view> -->
        <view class="benefit-item">更多剧情</view>
        <view class="benefit-item">更多灵感</view>
        <view class="benefit-item">更多沉浸式体验</view>
      </view>
    </view>

    <!-- 功能对比表格 -->
    <view class="comparison-table blur-glass">
      <view class="member-bg blur-glass" />
      <view class="table-header">
        <view class="header-cell header-label">权益</view>
        <view class="header-cell header-current">
          <text class="header-text">当前</text>
        </view>
        <view class="header-cell header-member">
          <text class="header-text">会员</text>
        </view>
      </view>
      <view class="table-body">
        <view wx:for="{{selectedPackage.benefitInfo}}" wx:key="index" class="table-row">
          <view class="table-cell cell-label">{{item.name}}</view>
          <view class="table-cell cell-value">{{item.normal}}</view>
          <view class="table-cell cell-value cell-member">{{item.vip}}</view>
        </view>
      </view>
    </view>
    
    <!-- 规则说明 -->
    <view class="rule-info">
      <view class="rule-info-title">规则说明</view>
      <view class="rule-info-item">
      1、一次可购买多个会员，有效期自动顺延。
      </view>
      <view class="rule-info-item">
      2、赠送积分，支付完成后，立即到账，无需等会员生效。
      </view>
      <view class="rule-info-item">
      3、支付成功后，不支持退款。
      </view>
    </view>
  </scroll-view>

  <view class="bottom-container">
    <!-- 套餐选择 -->
    <view class="package-selection">
      <view 
        wx:for="{{packages}}" 
        wx:key="id" 
        class="package-card blur-glass {{selectedPackage && selectedPackage.id === item.id ? 'package-card-selected' : ''}}" 
        bindtap="onSelectPackage" 
        data-id="{{item.id}}"
      >
        <view class="package-price-text">¥{{item.amountInYuan}}</view>
        <view class="package-name-text">{{item.title}}</view>
      </view>
    </view>

    <!-- 购买按钮 -->
    <view class="purchase-button" bindtap="onPurchase">
      <text class="purchase-price">¥{{selectedPackage ? selectedPackage.amountInYuan : '0'}}</text>
      <text class="purchase-text">立即购买</text>
    </view>

    <!-- 协议文本 -->
    <view class="agreement-text">
      <text>开通,即表示阅读并同意</text>
      <text class="agreement-link" bindtap="serviceTap">《会员服务协议》</text>
    </view>
  </view>
</view>

<t-toast id="t-toast" /> 
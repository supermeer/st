<view class="usercenter-page-container">
  <custom-nav
    class="custom-nav"
    show-back="{{false}}"
    show-left-logo="{{false}}"
    show-home="{{false}}"
    transparent="{{true}}"
  >
    <t-image slot="center" src="/static/usercenter/mine_nav.jpg" width="112rpx" height="44rpx" />
  </custom-nav>

  <view class="usercenter-content" style="height: {{contentHeight}}">
    <view class="user-info" bindtap="onUserInfoClick">
      <t-image class="user-info-avatar" src="{{userInfo.avatarUrl}}" />
      <view class="user-info-name">
        <text>{{userInfo.nickname || '小柚子'}}</text>
        <!-- <view class="user-info-uid">UID:123321</view> -->
      </view>
      <t-icon class="user-info-arr" name="chevron-right" size="32" color="#fff" />
    </view>
    <view class="score-box" bind:tap="onScoreClick">
      <t-image class="score-box-icon" src="/static/vip/score.png" />
      <text class="score-box-text">{{(pointInfo.pointBalance || 0) + (pointInfo.dailyFreeBalance || 0)}}</text>
      <text wx:if="{{!isDev}}" class="score-box-desc">今日赠送{{pointInfo.dailyFreeBalancePreset || 0}}积分已到账</text>
      <t-icon wx:if="{{!isDev}}" class="score-box-arr" name="chevron-right" size="18" />
    </view>
    <view class="vip-box" bind:tap="onVipRenewClick">
      <view class="vip-box-left-content">
        <view class="vip-box-header">
          <t-image wx:if="{{!vipInfo.ifVip}}" class="vip-box-header-icon" src="/static/vip/vip.png"/>
          <text class="vip-box-header-text">{{vipInfo.ifVip ? '星柚会员' : (isDev ? '沉浸式体验' : '开通会员')}}</text>
          <t-button wx:if="{{!vipInfo.ifVip && !isDev}}" class="open-vip-btn" bind:catchtap="onVipRenewClick">立即开通</t-button>
        </view>
        <view wx:if="{{vipInfo.ifVip}}" class="open-vip-btm-line">{{vipInfo.formattedMonthlyExpireTime}}</view>
        <view wx:else class="open-vip-btm-line">无线畅聊 记忆增强 更多灵感回复</view>
      </view>
      <t-image wx:if="{{vipInfo.ifVip}}" class="vip-box-icon" src="/static/vip/vip.png"/>
    </view>                                                        
    <view class="roles-title">智能体</view>
    <view class="role-list">
      <view 
        class="role-card" 
        wx:for="{{roleList}}" 
        wx:key="id"
        style="background-image: url('{{item.backgroundImage || item.avatar}}');"
        bind:tap="onRoleClick"
        data-id="{{item.id}}"
      >
        <view class="role-info">
          <view class="role-name-row">
            <text class="role-name">{{item.name}}</text>
          </view>
        </view>
      </view>
      <view wx:if="{{roleList.length === 0}}" class="role-empty-state">
        <t-icon name="empty" size="64" color="#ccc" />
        <text class="empty-text">暂无自定义智能体</text>
        <text class="empty-desc">快去创建吧！</text>
      </view>
    </view>
  </view>
</view>

<points-recharge-dialog
  id="pointsRechargeDialog"
/>

<t-toast id="t-toast" />
